import spacy
from spacy.util import minibatch, compounding
import random
from pathlib import Path

#Download del modello in Italiano
spacy.cli.download("it_core_news_sm")

# Caricamento del modello base in Italiano
nlp = spacy.load("it_core_news_sm")
print(nlp.pipe_names)

# Estrazione componente NER della pipeline
ner=nlp.get_pipe("ner")

# Visualizzazione delle label precedentemente presenti
#for i in ner.labels:
#  print(i)

###########################################################################
# README: Creazione dataset di training                                   #
# Copiare ed incollare qui il dataset di addestramento                    #
# NB: Se sono presenti più testi annotati, separare ogni inserimento      #
# con una vigola                                                          #
###########################################################################
TRAIN_DATA = \
[
#SET 1: Steve Jobs, Elon Musk, Jeff Bezos, Bill Gates , Silvio Berlusconi
('Steven Paul Jobs, detto Steve (San Francisco, 24 febbraio 1955 – Palo Alto, 5 ottobre 2011), è stato un imprenditore, informatico e inventore statunitense.È stato il cofondatore di Apple Inc. e ne è stato amministratore delegato fino al 24 agosto 2011, quando si è dimesso per motivi di salute (assumendo la carica di presidente del consiglio di amministrazione).', {'entities': [(181, 186, 'AZIENDA'), (65, 74, 'CITTA'), (31, 44, 'CITTA'), (12, 16, 'COGNOME')]}), ('Ha fondato anche la società NeXT Computer.', {'entities': [(28, 41, 'AZIENDA')]}), ("È stato inoltre fondatore e amministratore delegato di Pixar Animation Studios prima dell'acquisto da parte della Walt Disney Company, della quale era inoltre membro del consiglio di amministrazione oltre che maggiore azionista.", {'entities': [(114, 133, 'AZIENDA'), (55, 70, 'AZIENDA')]}), ("Jobs è stato classificato primo tra i 25 uomini d'affari più potenti per il 2007 da Fortune e persona dell'anno 2010 dal Financial Times.", {'entities': [(0, 4, 'COGNOME')]}), ('Molte persone note negli Stati Uniti hanno rilasciato dichiarazioni sulla morte di Steve Jobs, fra cui Barack Obama, Bill Gates, Bob Iger, Mark Zuckerberg, Sergey Brin, Larry Page, Tim Cook, Meg Whitman, Steve Ballmer e Richard Stallman.Elon Reeve Musk (Pretoria, 28 giugno 1971) è un imprenditore sudafricano con cittadinanza canadese naturalizzato statunitense.', {'entities': [(254, 262, 'CITTA'), (248, 252, 'COGNOME'), (228, 236, 'COGNOME'), (210, 217, 'COGNOME'), (195, 202, 'COGNOME'), (185, 189, 'COGNOME'), (175, 179, 'COGNOME'), (163, 167, 'COGNOME'), (144, 154, 'COGNOME'), (133, 137, 'COGNOME'), (122, 127, 'COGNOME'), (110, 115, 'COGNOME'), (89, 93, 'COGNOME')]}), ('È fondatore, CEO e CTO di Space Exploration Technologies Corporation (SpaceX), co-fondatore, CEO e product architect di Tesla e co-fondatore e CEO di Neuralink.', {'entities': [(150, 159, 'AZIENDA'), (120, 125, 'AZIENDA'), (70, 76, 'AZIENDA')]}), ('Inoltre è presidente di SolarCity, fondatore di The Boring Company e co-fondatore di PayPal e OpenAI.', {'entities': [(94, 100, 'AZIENDA'), (85, 91, 'AZIENDA'), (48, 66, 'AZIENDA'), (24, 33, 'AZIENDA')]}), ('Ha inoltre proposto un sistema di trasporto super veloce conosciuto come "Hyperloop".', {'entities': [(74, 83, 'AZIENDA')]}), ("Musk ha affermato che l'obiettivo di SolarCity, Tesla e SpaceX ruota intorno all'ideale di cambiare il mondo e l'umanità.", {'entities': [(56, 62, 'AZIENDA'), (48, 53, 'AZIENDA'), (37, 46, 'AZIENDA'), (0, 4, 'COGNOME')]}), ('Tramite Starlink, una costellazione di satelliti prodotta e gestita da SpaceX, Elon Musk vuole fornire internet ad alta velocità e bassa latenza a tutto il pianeta.Secondo Forbes, al 19 maggio 2021, con un patrimonio stimato di 146,7 miliardi di dollari, risulta essere il terzo uomo più ricco del mondo (per un piccolo periodo riuscì anche a superarlo con una differenza di 1 miliardo circa) dopo Bernard Arnault.Jeffrey Preston Bezos, nato Jorgensen (Albuquerque, 12 gennaio 1964), è un imprenditore statunitense, fondatore e presidente di Amazon, la più grande società di commercio elettronico al mondo.', {'entities': [(542, 548, 'AZIENDA'), (430, 435, 'COGNOME'), (406, 413, 'COGNOME'), (172, 178, 'AZIENDA'), (84, 88, 'COGNOME'), (71, 77, 'AZIENDA'), (8, 16, 'AZIENDA')]}), ('Inoltre è fondatore di Blue Origin, società di start up per voli spaziali, e proprietario del The Washington Post.', {'entities': [(94, 113, 'AZIENDA'), (23, 34, 'AZIENDA')]}), ("Secondo Forbes, al 19 maggio 2021 con un patrimonio stimato di 187.5 miliardi di dollari, risulta essere l'uomo più ricco al mondo.William Henry Gates III, meglio conosciuto come Bill Gates (Seattle, 28 ottobre 1955), è un imprenditore, programmatore, informatico e filantropo statunitense.", {'entities': [(145, 150, 'COGNOME'), (8, 14, 'AZIENDA')]}), ('È meglio conosciuto come il principale fondatore di Microsoft Corporation.', {'entities': [(52, 73, 'AZIENDA')]}), ('Durante la sua carriera in Microsoft, Gates ha tenuto le posizioni di presidente del consiglio di amministrazione (chairman), amministratore delegato (AD) e chief software architect, ed è anche stato il maggior azionista individuale fino a maggio del 2014.', {'entities': [(38, 43, 'COGNOME'), (27, 36, 'AZIENDA')]}), ("Nato e cresciuto a Seattle nello stato di Washington, Gates avviò Microsoft con l'amico di infanzia Paul Allen nel 1975 a Albuquerque, Nuovo Messico; sarebbe diventata l'azienda di software per personal computer più grande al mondo.", {'entities': [(122, 133, 'CITTA'), (105, 110, 'COGNOME'), (66, 75, 'AZIENDA'), (54, 59, 'COGNOME'), (42, 52, 'CITTA')]}), ('A giugno 2006, Gates annunciò che sarebbe passato a un ruolo part-time in Microsoft e per concentrarsi a tempo pieno nella Fondazione Bill & Melinda Gates, la fondazione privata di beneficenza che lui e la ex moglie, Melinda Gates, istituirono nel 2000.', {'entities': [(225, 230, 'COGNOME'), (74, 83, 'AZIENDA'), (15, 20, 'COGNOME')]}), ('Trasferì gradualmente i suoi incarichi a Ray Ozzie e Craig Mundie.', {'entities': [(59, 65, 'COGNOME'), (45, 50, 'COGNOME')]}), ('Si dimise da chairman di Microsoft a febbraio del 2014 e assunse un nuovo ruolo come advisor tecnologico del nuovo CEO Satya Nadella.Gates è uno dei più conosciuti imprenditori della rivoluzione del personal computer.', {'entities': [(133, 138, 'COGNOME'), (125, 132, 'COGNOME'), (25, 34, 'AZIENDA')]}), ('Questa opinione è stata sostenuta da numerose sentenze giudiziarie.Dal 1987, Gates è incluso nella lista delle persone più ricche del mondo secondo Forbes.', {'entities': [(148, 154, 'AZIENDA'), (77, 82, 'COGNOME')]}), ('Tuttavia, il 27 luglio 2017, e dal 27 ottobre 2017, è stato sorpassato dal fondatore e CEO di Amazon.com Jeff Bezos, che al tempo aveva un patrimonio stimato di US$90,6 miliardi.Al 19 maggio 2021, Gates ha un patrimonio di $126.9 miliardi, rendendolo la quarta persona più ricca del mondo dopo Elon Musk.Dopo aver lasciato Microsoft, Gates perseguì una serie di imprese filantropiche.', {'entities': [(334, 339, 'COGNOME'), (323, 332, 'AZIENDA'), (299, 303, 'COGNOME'), (197, 202, 'COGNOME'), (110, 115, 'COGNOME'), (94, 100, 'COGNOME')]}), ('Nel 2009, Gates e Warren Buffett fondarono The Giving Pledge, campagna per mezzo della quale loro e altri miliardari si impegnano di donare almeno metà del proprio patrimonio alla filantropia.', {'entities': [(43, 60, 'AZIENDA'), (25, 32, 'COGNOME'), (10, 15, 'COGNOME')]}), ("La fondazione lavora per salvare vite e migliorare la salute globale, e sta lavorando con Rotary International per debellare la poliomielite.Silvio Berlusconi (Milano, 29 settembre 1936) è un politico e imprenditore italiano, conosciuto anche come il Cavaliere, soprannome assegnatogli dal giornalista sportivo Gianni Brera, in ragione dell'onorificenza a cavaliere del lavoro, conferitagli nel 1977 dal presidente della Repubblica Giovanni Leone e alla quale ha rinunciato nel 2014.Ha iniziato l'attività imprenditoriale nel campo dell'edilizia.", {'entities': [(441, 446, 'COGNOME'), (318, 323, 'COGNOME'), (160, 166, 'CITTA'), (148, 158, 'COGNOME'), (90, 110, 'AZIENDA')]}), ("Nel 1975 ha costituito la società finanziaria Fininvest e nel 1993 la società di produzione multimediale Mediaset, nelle quali convergono altre società come Arnoldo Mondadori Editore e Silvio Berlusconi Communications, rimanendo figura simbolo dell'omonima famiglia Berlusconi.", {'entities': [(165, 174, 'AZIENDA'), (105, 113, 'AZIENDA'), (46, 55, 'AZIENDA')]}), ("Con 3340 giorni complessivi (corrispondenti ad oltre nove anni) è il politico che è rimasto in carica più a lungo nel ruolo di presidente del Consiglio dell'Italia repubblicana, superato in epoche precedenti solo da Benito Mussolini e Giovanni Giolitti; inoltre ha presieduto i due governi più duraturi dalla proclamazione della Repubblica.", {'entities': [(244, 252, 'COGNOME'), (223, 232, 'COGNOME')]}), ("È stato l'unico leader politico mondiale ad aver presenziato a 3 vertici del G7/G8 come Presidente del Paese ospitante (20º G7 del 1994 a Napoli, il 27º G8 del 2001 a Genova e il 35º G8 del 2009 a L'Aquila).", {'entities': [(197, 205, 'CITTA')]}), ("Secondo la rivista americana Forbes, con un patrimonio personale stimato in 7,3 miliardi di dollari USA (circa 6 miliardi di euro), Berlusconi è, nel 2021, il sesto uomo più ricco d'Italia e il 318º più ricco del mondo.", {'entities': [(132, 142, 'COGNOME'), (29, 35, 'AZIENDA')]}), ('Nel 2009, Forbes lo ha classificato 12º nella sua lista delle persone più potenti del mondo per via della sua dominazione della politica italiana.È stato imputato in oltre venti procedimenti giudiziari.', {'entities': [(10, 16, 'AZIENDA')]}), ('Il 1º agosto 2013 è stato condannato a quattro anni di reclusione (con tre anni condonati dall\'indulto del 2006) per frode fiscale, con sentenza passata in giudicato nel cosiddetto "processo Mediaset".', {'entities': [(191, 199, 'AZIENDA')]}), ("Berlusconi ha quindi cessato di essere un parlamentare dopo quasi vent'anni di presenza ininterrotta nelle due camere (dall'aprile 1994 al novembre 2013).", {'entities': [(0, 10, 'COGNOME')]})
,
#SET 2: "Reed Hastings","John Elkann","Oprah Winfrey"
('Wilmot Reed Hastings Jr. (Boston, 8 ottobre 1960) è un imprenditore e filantropo statunitense.', {'entities': [(26, 32, 'CITTA'), (12, 20, 'COGNOME')]}), ('È co-fondatore, presidente del consiglio di amministrazione e amministratore delegato di Netflix e ha fatto parte del consiglio di amministrazione di Facebook dal 2011 fino al 2019 e di altre numerose organizzazioni no profit.', {'entities': [(150, 158, 'AZIENDA'), (89, 96, 'AZIENDA')]}), ("Ex membro del California State Board of Education, Hastings è un sostenitore della riforma dell'istruzione attraverso le Charter school.Reed Hastings prima di tutto ciò prese parte al consiglio di amministrazione di Microsoft dal 2007 fino al 2012.", {'entities': [(216, 225, 'AZIENDA'), (121, 149, 'AZIENDA'), (51, 59, 'COGNOME'), (14, 49, 'AZIENDA')]}), ('A settembre del 2016, è stato riportato che Reed possedesse oltre 10 milioni di euro delle azioni di Facebook.', {'entities': [(101, 109, 'AZIENDA')]}), ("Il 12 aprile 2019, Facebook annunciò che Hastings avrebbe lasciato il consiglio a partire dal 30 maggio 2019.John Philip Jacob Elkann (New York, 1º aprile 1976) è un imprenditore e dirigente d'azienda italiano.", {'entities': [(135, 143, 'CITTA'), (127, 133, 'COGNOME'), (41, 49, 'COGNOME'), (19, 27, 'AZIENDA')]}), ('Designato dal nonno Gianni Agnelli come suo successore, è presidente e amministratore delegato della Exor N.V., una holding di investimento controllata dalla famiglia Agnelli, che ha tra i suoi investimenti anche PartnerRe, Ferrari, CNH Industrial e Juventus.', {'entities': [(250, 258, 'AZIENDA'), (233, 247, 'AZIENDA'), (224, 231, 'AZIENDA'), (213, 222, 'AZIENDA'), (167, 174, 'COGNOME'), (101, 110, 'AZIENDA'), (27, 34, 'COGNOME')]}), ('Dal 16 gennaio 2021 è presidente di Stellantis, Ferrari, Giovanni Agnelli B.V. e GEDI Gruppo Editoriale.Oprah Gail Winfrey, nota come Oprah Winfrey o semplicemente Oprah (Kosciusko, 29 gennaio 1954), è una conduttrice televisiva, autrice televisiva, attrice, scrittrice, filantropa e imprenditrice statunitense.', {'entities': [(171, 180, 'CITTA'), (140, 147, 'COGNOME'), (115, 122, 'COGNOME'), (81, 103, 'AZIENDA'), (57, 78, 'AZIENDA'), (48, 55, 'AZIENDA'), (36, 46, 'AZIENDA')]}), ("Nel 2011 le è stato conferito il Premio Oscar umanitario Jean Hersholt, e nel 2018 il Golden Globe alla carriera.Dal 2008 è proprietaria di una rete televisiva on-demand, Oprah Winfrey Network, in partnership con Discovery Inc., distribuito in numerosi paesi, tra cui Stati Uniti, Canada, Australia, Regno Unito, Sudafrica e Russia, possiede una quota della multinazionale WW International, investendo inoltre nell'editoria, fondando il The Oprah Magazine, il marchio editoriale An Oprah Book, oltre ad aver co-scritto dieci libri autobiografici.", {'entities': [(479, 492, 'AZIENDA'), (437, 455, 'AZIENDA'), (373, 389, 'AZIENDA'), (213, 227, 'AZIENDA'), (171, 192, 'AZIENDA'), (62, 70, 'COGNOME')]})
,
#SET 3: "Bernard Arnault","Giovanni Ferrero"
('Bernard Arnault (Roubaix, 5 marzo 1949) è un imprenditore francese.', {'entities': [(17, 24, 'CITTA'), (8, 15, 'COGNOME')]}), ('Proprietario del gruppo del lusso LVMH, è a capo della prima azienda francese, secondo Bloomberg, la prima in Europa e la terza a livello mondiale.', {'entities': [(87, 96, 'AZIENDA'), (34, 38, 'AZIENDA')]}), ("A giugno 2021, secondo Forbes è l'uomo più ricco al mondo con un patrimonio di 192.4 miliardi di dollari.La Ferrero è una multinazionale italiana con sede in Lussemburgo specializzata in prodotti dolciari.", {'entities': [(108, 115, 'AZIENDA'), (23, 29, 'AZIENDA')]}), ('È stata fondata da Giuseppe Ferrero, il fratello Pietro Ferrero e dalla moglie Piera Cillario nel 1946 ad Alba (Cuneo).', {'entities': [(112, 117, 'CITTA'), (106, 110, 'CITTA'), (85, 93, 'COGNOME'), (56, 63, 'COGNOME'), (28, 35, 'COGNOME')]}), ("Altri stabilimenti italiani sono a Pozzuolo Martesana, Balvano e Sant'Angelo dei Lombardi.", {'entities': [(65, 89, 'CITTA'), (55, 62, 'CITTA'), (35, 53, 'CITTA')]}), ('La holding Ferrero International SA, sin dal 1973, ha sede legale, domicilio fiscale e amministrativo a Findel di Sandweiler in Lussemburgo, dove nel dicembre 2019 è stata inaugurata la nuova sede centrale e quartier generale mondiale del Gruppo.', {'entities': [(104, 124, 'CITTA'), (11, 35, 'AZIENDA')]}), ('La cassaforte di famiglia Fedesa ha invece sede a Montecarlo.', {'entities': [(26, 32, 'AZIENDA')]}), ('Inoltre in Lussemburgo è presente anche la Teseo Capital Sicav Sif S.A., una finanziaria di investimento capitali riconducibile al gruppo, controllata dalla fiduciaria CDM International Holding S.C.S.', {'entities': [(168, 200, 'AZIENDA'), (43, 71, 'AZIENDA')]}), ("In Belgio hanno invece sede la CTH Invest S.A., un'altra holding finanziaria estera del gruppo, e la FFH Holding, una finanziaria utilizzata dal gruppo per le acquisizioni fuori dall'Europa.", {'entities': [(101, 112, 'AZIENDA'), (31, 46, 'AZIENDA')]}), ('Tutte queste entità sono coinvolte nella gestione e nel controllo della Ferrero.', {'entities': [(72, 79, 'AZIENDA')]}), ('Costituita nel 2016 in uno studio notarile di Bruxelles da Gmbf Investment s.à.r.l.', {'entities': [(59, 83, 'AZIENDA')]}), ("e Giovanni Ferrero sotto la supervisione commissariale di un'altra entità, la Peter Bogaert BV BVBA, all'inizio del 2021 ha assorbito e incorporato la CDM International.", {'entities': [(151, 168, 'AZIENDA'), (78, 99, 'AZIENDA'), (11, 18, 'COGNOME')]}), ("Nel marzo 2019 il Reputation Institute (società leader mondiale nella misurazione e gestione della reputazione aziendale) dopo aver realizzato un'indagine in quindici Paesi intervistando più di 80.000 consumatori, ha collocato Ferrero in posizione n.19 tra i marchi più affidabili e con migliore reputazione al mondo (primo brand italiano della lista) in una classifica dove sul podio si collocano Rolex, Lego e Disney e dove si trovano tra i primi cento posti anche altre imprese italiane come Pirelli (posizione n.23), Armani (n.24), Barilla (n.31) e Lavazza (n.38).", {'entities': [(553, 560, 'AZIENDA'), (536, 543, 'AZIENDA'), (521, 527, 'AZIENDA'), (495, 502, 'AZIENDA'), (412, 418, 'AZIENDA'), (405, 409, 'AZIENDA'), (398, 403, 'AZIENDA'), (227, 234, 'AZIENDA'), (18, 38, 'AZIENDA')]}), ('Nella lista 2020 Ferrero è stata di nuovo inclusa nel ranking delle prime 100 imprese mondiali per reputazione, ma superata in classifica dalla Ferrari (in posizione n.4) come migliore industria italiana secondo il giudizio dei consumatori.', {'entities': [(144, 151, 'AZIENDA'), (17, 24, 'AZIENDA')]}), ("Il bilancio generale di gruppo 2018 di Ferrero International ha riportato un fatturato pari a € 10,7 miliardi; l'utile netto è stato di € 736,4 milioni.", {'entities': [(39, 60, 'AZIENDA')]}), ('Nel 2019 Ferrero International ha realizzato utili per 928 milioni di €; nel 2020 il fatturato ha raggiunto 12,3 miliardi di €.', {'entities': [(9, 30, 'AZIENDA')]}), ("All'inizio del 2020 la deputata laburista britannica Rachel Reeves ha apertamente accusato la multinazionale di frodare il fisco del Regno Unito, evidenziando come la divisione inglese del gruppo, a fronte di 419 milioni di £ di fatturato realizzato nell'ultimo anno (pari a 500 milioni di €), abbia versato nelle casse dell'erario britannico appena 110 mila € (e complessivamente 600 mila € negli ultimi dieci anni).", {'entities': [(60, 66, 'COGNOME')]}), ('Secondo alcuni analisti fiscali che hanno esaminato il caso, Ferrero International utilizzerebbe lo stratagemma di spostare gli utili realizzati dalle sue varie filiali mondiali dalla nazione di origine al Lussemburgo, da dove i proventi sarebbero poi spostati nel Principato di Monaco, Stato in cui è situata Fedesa, la cassaforte del gruppo, dove non esistono imposte sul reddito.', {'entities': [(310, 316, 'AZIENDA'), (61, 82, 'AZIENDA')]})
,
#SET 4: "Tim Cook", "Sergio Marchionne", "Leonardo del Vecchio", "Jan Koum", "Amancio Ortega", "Richard Branson"
("Timothy Donald Cook, più noto come Tim Cook (Mobile, 1º novembre 1960), è un dirigente d'azienda, filantropo e ingegnere statunitense, amministratore delegato di Apple dal 24 agosto 2011.", {'entities': [(162, 167, 'AZIENDA'), (45, 51, 'CITTA'), (39, 43, 'COGNOME'), (15, 19, 'COGNOME')]}), ('Cook è entrato in Apple nel marzo 1998 come vice presidente per le operazioni mondiali, quindi ha ricoperto il ruolo di vice presidente esecutivo per le vendite e le operazioni mondiali.', {'entities': [(18, 23, 'AZIENDA'), (0, 4, 'COGNOME')]}), ("È stato nominato amministratore delegato il 24 agosto 2011, prima della morte di Jobs ad ottobre di quell'anno.", {'entities': [(81, 85, 'COGNOME')]}), ('Nel 2014, Cook è diventato il primo amministratore delegato di una società Fortune 500 a dichiarasi pubblicamente omosessuale.', {'entities': [(75, 86, 'AZIENDA'), (10, 14, 'COGNOME')]}), ('Cook fa anche parte dei consigli di amministrazione di Nike, National Football Foundation, ed è un fiduciario della Università Duke.', {'entities': [(61, 89, 'AZIENDA'), (55, 59, 'AZIENDA'), (0, 4, 'COGNOME')]}), ("A marzo 2015, ha dichiarato di aver pianificato di donare tutta la sua fortuna in beneficenza.Sergio Marchionne (Chieti, 17 giugno 1952 – Zurigo, 25 luglio 2018) è stato un dirigente d'azienda italiano naturalizzato canadese.", {'entities': [(138, 144, 'CITTA'), (113, 119, 'CITTA'), (101, 111, 'COGNOME')]}), ('È noto a livello internazionale per aver guidato il profondo rinnovamento della FIAT.', {'entities': [(80, 84, 'AZIENDA')]}), ('Ha ricoperto ruoli importanti nel gruppo Fiat: è stato amministratore delegato di Fiat Chrysler Automobiles N.V., FCA Italy e FCA US, di cui è stato anche presidente.', {'entities': [(126, 132, 'AZIENDA'), (114, 123, 'AZIENDA'), (82, 112, 'AZIENDA'), (41, 45, 'AZIENDA')]}), ("È stato presidente anche di CNH Industrial N.V. e Ferrari N.V., oltre che Presidente e amministratore delegato di Ferrari S.p.A.. Nel 2011 è stato inserito dal periodico statunitense Time nell'annuale elenco delle cento persone più influenti del mondo, classificandosi 51º.È stato inoltre vicepresidente di Exor N.V. e membro permanente della Fondazione Giovanni Agnelli, Presidente del CdA dell'ACEA (associazione costruttori) per l'anno 2012 e membro del CdA del Peterson Institute for International Economics, nonché co-presidente del Consiglio per le Relazioni tra Italia e Stati Uniti.Leonardo Del Vecchio (Milano, 22 maggio 1935) è un imprenditore italiano, fondatore e presidente di Luxottica e presidente esecutivo di EssilorLuxottica, la più grande holding produttrice e venditrice mondiale di occhiali e lenti che conta circa 80.000 dipendenti e oltre 9.000 negozi.", {'entities': [(726, 742, 'AZIENDA'), (690, 699, 'AZIENDA'), (612, 618, 'CITTA'), (599, 610, 'COGNOME'), (465, 511, 'AZIENDA'), (396, 400, 'AZIENDA'), (363, 370, 'COGNOME'), (307, 316, 'AZIENDA'), (183, 187, 'AZIENDA'), (114, 128, 'AZIENDA'), (50, 62, 'AZIENDA'), (28, 47, 'AZIENDA')]}), ('È anche un importante azionista di Covivio e Assicurazioni Generali.', {'entities': [(45, 67, 'AZIENDA'), (35, 42, 'AZIENDA')]}), ("La sua ricchezza al 2021 è stata valutata dalla rivista Forbes per circa 24.7 miliardi di dollari, rendendolo il secondo uomo più ricco d'Italia e il 59º al mondo.Jan Koum (Kiev, 24 febbraio 1976) è un imprenditore e informatico statunitense.", {'entities': [(173, 177, 'CITTA'), (167, 171, 'COGNOME'), (56, 62, 'AZIENDA')]}), ("È il coofondatore di WhatsApp (insieme a Brian Acton), un'applicazione di messaggistica mobile che è stata acquistata da Facebook Inc. nel febbraio del 2014 per 19 miliardi di dollari.", {'entities': [(121, 134, 'AZIENDA'), (47, 52, 'COGNOME'), (21, 29, 'AZIENDA')]}), ("Il 30 aprile 2018 ha lasciato Facebook Inc. e, di conseguenza, ha abbandonato anche la carica di CEO di WhatsApp che ricopriva fin dall'atto della creazione dell'applicazione.", {'entities': [(104, 112, 'AZIENDA'), (30, 43, 'AZIENDA')]}), ('Nel 2017 Forbes stima il suo patrimonio in 9,8 miliardi di dollari.Amancio Ortega Gaona (Busdongo, 28 marzo 1936) è un imprenditore spagnolo, fondatore della catena internazionale di negozi di abbigliamento Zara.', {'entities': [(207, 211, 'AZIENDA'), (89, 97, 'CITTA'), (82, 87, 'COGNOME'), (9, 15, 'AZIENDA')]}), ('Secondo Forbes, al 15 marzo 2021 è il 10° uomo più ricco del mondo dopo Sergey Brin, nonché il più ricco di Spagna, con un patrimonio di 82.7 miliardi di dollari.Sir Richard Charles Nicholas Branson (Londra, 18 luglio 1950) è un imprenditore britannico, fondatore del Virgin Group, il quale comprende oltre 400 società.', {'entities': [(268, 280, 'AZIENDA'), (200, 206, 'CITTA'), (191, 198, 'COGNOME'), (79, 83, 'COGNOME'), (8, 14, 'AZIENDA')]}), ('Secondo la rivista Forbes nel 2020 il suo patrimonio ammonta a circa 4,3 miliardi di dollari..', {'entities': [(19, 25, 'AZIENDA')]})
,
#SET 5: Warren Buffett, Mark Zuckerberg, Larry Page, Sundar Pichai, Satya Nadella, Howard Schultz
('Warren Edward Buffett (Omaha, 30 agosto 1930) è un imprenditore, economista e filantropo statunitense, soprannominato «oracolo di Omaha» per la sua sorprendente abilità negli investimenti finanziari e nel predire guadagni e perdite .', {'entities': [(130, 135, 'CITTA'), (23, 28, 'CITTA'), (14, 21, 'COGNOME')]}), ("Nel 2008, secondo la rivista Forbes, è stato l'uomo più ricco del mondo, mentre nel 2015, con un patrimonio stimato di 90,5 miliardi di dollari, sarebbe il quarto uomo più ricco del mondo, dopo Bill Gates e Carlos Slim Helù.", {'entities': [(219, 223, 'COGNOME'), (199, 204, 'COGNOME'), (29, 35, 'AZIENDA')]}), ('Al 1 giugno 2021 risulta essere il sesto uomo più ricco del mondo dopo Mark Zuckerberg con un patrimonio di 109.5 miliardi di dollari.È anche un notevole filantropo poiché ha promesso di impegnare il 99% del suo patrimonio in cause filantropiche, in particolare tramite la Gates Foundation.', {'entities': [(273, 289, 'AZIENDA'), (76, 86, 'COGNOME')]}), ('Tra i personaggi più significativi della storia della finanza, viene presentato nei suoi interventi con la formula «Ladies and Gentlemen, the legendary investor Warren Buffett».Mark Elliot Zuckerberg (IPA: [mɑɹk ˈɛliət ˈzʌkəɹbɜɹg]; White Plains, 14 maggio 1984) è un informatico e imprenditore statunitense, conosciuto per essere uno dei fondatori del social network Facebook.', {'entities': [(367, 375, 'AZIENDA'), (232, 244, 'CITTA'), (189, 199, 'COGNOME'), (168, 175, 'COGNOME')]}), ("Dall'aprile 2013 Zuckerberg è presidente e amministratore delegato di Facebook Inc..", {'entities': [(70, 83, 'AZIENDA'), (17, 27, 'COGNOME')]}), ("Insieme ai suoi compagni di stanza e studenti dell'Harvard University (Eduardo Saverin, Andrew McCollum, Dustin Moskovitz e Chris Hughes) Zuckerberg creò Facebook in una stanza del dormitorio di Harvard, presentando poi il progetto anche ad altri campus universitari degli Stati Uniti, per poi trasferirsi a Palo Alto in California.", {'entities': [(308, 317, 'CITTA'), (154, 162, 'AZIENDA'), (138, 148, 'COGNOME'), (130, 136, 'COGNOME'), (112, 121, 'COGNOME'), (95, 103, 'COGNOME'), (79, 86, 'COGNOME')]}), ("Nel 2007, all'età di 23 anni, Zuckerberg divenne miliardario a seguito del successo di Facebook.", {'entities': [(87, 95, 'AZIENDA'), (30, 40, 'COGNOME')]}), ('Nel 2012, in tutto il mondo, il numero di utenti registrati a Facebook raggiunse il miliardo.', {'entities': [(62, 70, 'AZIENDA')]}), ('Zuckerberg fu coinvolto in diverse azioni legali che furono intentate da altri membri del gruppo, i quali reclamavano una quota azionaria sulla base del loro coinvolgimento durante la fase di sviluppo di Facebook.', {'entities': [(204, 212, 'AZIENDA'), (0, 10, 'COGNOME')]}), ("Dal 2010 Time inserisce Zuckerberg tra le 100 persone più ricche e influenti del mondo nell'annuale classifica di persona dell'anno.", {'entities': [(24, 34, 'COGNOME')]}), ('Nel 2011 Zuckerberg si posizionò primo nella classifica degli "Ebrei più influenti del mondo" redatta dal Jerusalem Post e da allora ha sempre occupato le primissime posizioni di quella classifica.', {'entities': [(9, 19, 'COGNOME')]}), ('Una trasposizione cinematografica della storia della nascita di Facebook è stata narrata nel film del 2010 The Social Network.Al 1 giugno 2021, secondo Forbes, con un patrimonio stimato di 119.4 miliardi di dollari è il 5º uomo più ricco del mondo dopo Bill Gates.Lawrence Page, detto Larry (East Lansing, 26 marzo 1973) è un imprenditore statunitense, fondatore di Google con Sergej Brin.', {'entities': [(384, 388, 'COGNOME'), (366, 372, 'AZIENDA'), (292, 304, 'CITTA'), (273, 277, 'COGNOME'), (258, 263, 'COGNOME'), (64, 72, 'AZIENDA')]}), ("È stato amministratore delegato di Google una prima volta sino all'agosto 2001 ed una seconda volta dall'aprile 2011 al luglio 2015.", {'entities': [(35, 41, 'AZIENDA')]}), ("Successivamente ha assunto il ruolo di CEO di Alphabet, la holding che controlla le attività di Google con una capitalizzazione di Borsa nel 2018 di 810 miliardi di dollari e creata nel 2015 per permettergli di focalizzarsi sui problemi tecnologici di lungo termine, fino al 3 dicembre 2019.Page è l'inventore di PageRank, il più conosciuto algoritmo di ricerca di Google.Secondo Forbes, al 1 giugno 2021, Page è il 7° più ricco al mondo dopo Warren Buffett con un patrimonio stimato di 102.8 miliardi di dollari.Pichai Sundararajan (in tamil சுந்தர் பிச்சை; Madurai, 10 giugno 1972) è un dirigente d'azienda indiano naturalizzato statunitense, amministratore delegato di Google Inc. dal 2 ottobre 2015 e di Alphabet dal 3 dicembre 2019.", {'entities': [(708, 716, 'AZIENDA'), (672, 683, 'AZIENDA'), (559, 566, 'CITTA'), (520, 532, 'COGNOME'), (450, 457, 'COGNOME'), (365, 371, 'AZIENDA'), (96, 102, 'AZIENDA'), (46, 54, 'AZIENDA')]}), ("Nel 2019 risulta il manager più pagato d'America con 280 milioni di dollari, nel 2020 è incluso dalla rivista Time tra le 100 persone più influenti.Satya Nadella, (telugu సత్యనారాయణ నాదెళ్ల, urdu نادیلا ستیہ ناراینہ) (Hyderabad, 19 agosto 1967), è un dirigente d'azienda indiano naturalizzato statunitense, dal 4 febbraio 2014 amministratore delegato (CEO) di Microsoft.Howard Schultz (New York, 19 luglio 1953) è un imprenditore statunitense.", {'entities': [(386, 394, 'CITTA'), (377, 384, 'COGNOME'), (360, 369, 'AZIENDA'), (218, 227, 'CITTA'), (154, 161, 'COGNOME')]}), ('È noto per essere stato amministratore delegato di Starbucks dal 1987.', {'entities': [(51, 60, 'AZIENDA')]})
]
# Aggiunta nuove label
LABELS = ["COGNOME", "CITTA", "AZIENDA"]
for i in LABELS:
  ner.add_label(i)

# Resume training
optimizer = nlp.resume_training()
move_names = list(ner.move_names)

# Lista delle componenti della pipeline da addestrare
pipe_exceptions = ["ner", "tagger", "parser"]

# Settaggio delle componenti della pipeline che non devono essere soggette a training
other_pipes = [pipe for pipe in nlp.pipe_names if pipe not in pipe_exceptions]

# Inizio addestramento disabilitando le componenti non soggette al training
with nlp.disable_pipes(*other_pipes) :

  sizes = compounding(1.0, 4.0, 1.001)
  # Training per 30 iterazioni
  for itn in range(30):
    # shuffle examples before training
    random.shuffle(TRAIN_DATA)
    # batch up the examples using spaCy's minibatch
    batches = minibatch(TRAIN_DATA, size=sizes)
    # Dictionary to store losses
    losses = {}
    for batch in batches:
      texts, annotations = zip(*batch)
      # Invocazione update() dopo ogni iterazione
      nlp.update(texts, annotations, sgd=optimizer, drop=0.35, losses=losses)
      print("Losses", losses)


# Path in cui salvare il modello
model_output_dir=Path(r'SpacyNerTrainedModel')

# Salvataggio del modello nella directory di output
if not model_output_dir.exists():
  model_output_dir.mkdir()
nlp.meta['name'] = 'my_ner'  # Rinominazione del modello
nlp.to_disk(model_output_dir)
print("[INFO] Modello salvato nel path: ", model_output_dir)
print("FINISH")

